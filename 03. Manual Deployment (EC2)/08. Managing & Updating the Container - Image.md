# **Managing & Updating the Container / Image**

---

# ğŸ¯ **Goal**

Learn how to:

1. Update the app running on EC2
2. Deploy these updates
3. Stop or shut down the environment
4. Understand limitations of this approach

---

# ğŸ”§ **1. Updating the Code**

You make a change locally (e.g., adding `!!!!` in HTML).
This change is **only local** â€” nothing updates on EC2 automatically.

To push updates to the remote server, follow this flow:

---

# ğŸ— **2. Build and Push an Updated Docker Image (Local Machine)**

### **Step A â€” Rebuild the image**

```bash
docker build -t node-dep-example-1 .
```

### **Step B â€” Tag it**

```bash
docker tag node-dep-example-1 yourname/node-dep-example-1
```

### **Step C â€” Push it to Docker Hub**

```bash
docker push yourname/node-dep-example-1
```

Docker Hub only uploads the **changed layers**, so itâ€™s fast.

---

# ğŸŒ **3. Deploy the Update on the EC2 Server**

### **Step 1 â€” Stop the currently running container**

SSH into EC2, then run:

```bash
sudo docker ps
sudo docker stop <container_name>
```

Now the app is no longer accessible via your public IP.

---

# ğŸ“¥ **4. Important: Docker does NOT auto-update images**

Running `docker run` again **will NOT pull the new version**.
Docker only checks if the image exists locally â€” if yes, it uses that.

So you must **manually pull the updated image**:

```bash
sudo docker pull yourname/node-dep-example-1
```

This fetches the newest uploaded version.

---

# ğŸš€ **5. Start the Updated Container**

```bash
sudo docker run -d --rm -p 80:80 yourname/node-dep-example-1
```

Now when you refresh the browser â†’
You see the updated output (example: the exclamation marks appear).

---

# ğŸ›‘ **6. Stopping or Removing Everything**

### **Stop the app container**

```bash
sudo docker stop <container-name>
```

Your EC2 IP now stops responding (no web server running anymore).

### **Stop EC2 entirely**

In AWS console:

**Instances â†’ Select instance â†’ Actions â†’ Instance State â†’ Terminate**

This deletes:

* The EC2 machine
* Its storage
* Your app
* All containers & data

This is permanent.

---

# âš ï¸ **7. Why This Approach Wonâ€™t Be the Final Deployment Method**

This method works, but it comes with drawbacks:

âŒ Requires manual SSH into EC2
âŒ Manual docker commands every time
âŒ Manual pulling of updates
âŒ No automatic scaling
âŒ No load balancing
âŒ You must secure the server yourself
âŒ Not suitable for multi-container systems

Later , we'll **better deployment approaches** that solve these issues.

---

# âœ… **Final Takeaway**

Updating a Dockerized app on EC2 involves:

1. Rebuild â†’
2. Tag â†’
3. Push â†’
4. SSH â†’
5. Stop old container â†’
6. Pull new version â†’
7. Run new container

A simple but manual deployment workflow â€” good for learning but not production-ready.